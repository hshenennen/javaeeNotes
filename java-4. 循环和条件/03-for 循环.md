

---

# Java 中的 `for` 循环

> [!info] 学习目标
> - 掌握传统 `for` 循环的语法和执行流程
> - 理解循环变量的作用域
> - 学会使用 `for` 循环遍历数组和执行重复任务
> - 了解增强型 `for` 循环（for-each）
> - 避免常见错误（如无限循环、索引越界）

---

## 1. 什么是 `for` 循环？

`for` 是一种**重复执行代码块**的控制结构，特别适合**已知循环次数**的场景（如遍历数组、打印 1~10）。

> 💡 核心思想：**“重复做某事 N 次”**

---

## 2. 传统 `for` 循环语法

```java
for (初始化; 条件判断; 迭代更新) {
    // 循环体（重复执行的代码）
}
```

### 三部分说明：
| 部分 | 作用 | 执行时机 |
|------|------|--------|
| **初始化** | 声明并初始化循环变量（如 `int i = 0`） | **只执行一次**（循环开始前） |
| **条件判断** | 每次循环前检查是否继续（必须是 `boolean`） | 每次循环**开始前**检查 |
| **迭代更新** | 每次循环结束后更新循环变量（如 `i++`） | 每次循环**结束后**执行 |

### 🌰 示例：打印 1 到 5
```java
for (int i = 1; i <= 5; i++) {
    System.out.println("第 " + i + " 次循环");
}
```

**执行流程**：
1. `int i = 1`（初始化）
2. 检查 `i <= 5` → true → 执行循环体
3. 执行 `i++` → i = 2
4. 检查 `i <= 5` → true → 执行循环体
5. ……直到 `i = 6`，条件为 false，循环结束

---

## 3. 循环变量的作用域

- 在 `for` 的初始化部分声明的变量，**作用域仅限于循环内部**
- 循环结束后，变量**不可访问**

```java
for (int i = 0; i < 3; i++) {
    System.out.println(i); // ✅ 可以
}
// System.out.println(i); // ❌ 编译错误！i 超出作用域
```

> ✅ 好处：避免变量污染，提高代码安全性

---

## 4. 常见用法示例

### ✅ 1. 倒序循环
```java
for (int i = 10; i >= 1; i--) {
    System.out.println(i);
}
```

### ✅ 2. 步长不为 1
```java
for (int i = 0; i <= 100; i += 10) {
    System.out.print(i + " "); // 输出：0 10 20 ... 100
}
```

### ✅ 3. 遍历数组（传统方式）
```java
int[] numbers = {10, 20, 30, 40};
for (int i = 0; i < numbers.length; i++) {
    System.out.println("索引 " + i + " 的值是 " + numbers[i]);
}
```

---

## 5. 增强型 `for` 循环（for-each）

Java 5 引入，用于**简化集合或数组的遍历**，无需索引。

### 语法：
```java
for (元素类型 变量名 : 数组或集合) {
    // 使用变量名访问当前元素
}
```

### 🌰 示例：
```java
String[] fruits = {"苹果", "香蕉", "橙子"};
for (String fruit : fruits) {
    System.out.println(fruit);
}
```

### ✅ 优点：
- 代码更简洁
- 不会索引越界
- 自动遍历所有元素

### ⚠️ 局限：
- **不能获取索引**
- **不能修改原数组/集合的结构**（但可以修改元素内容，如果是引用类型）

---

## 6. 无限循环（慎用！）

如果条件永远为 `true`，就会无限循环：

```java
for (;;) {
    // 无限循环（等价于 while(true)）
    // 需用 break 或 return 退出
}
```

> 💡 通常用于服务器监听、游戏主循环等场景，**初学者避免误用**

---

## 7. 与 `while` 循环的区别

| 对比项 | `for` 循环 | `while` 循环 |
|--------|-----------|-------------|
| 适用场景 | **已知循环次数**或有明确计数器 | **未知循环次数**（如用户输入、文件读取） |
| 结构 | 初始化、条件、更新写在一起 | 条件单独写，初始化和更新分散 |
| 可读性 | 计数循环更清晰 | 条件复杂时更灵活 |

> ✅ **经验法则**：  
> - 遍历数组/固定次数 → 用 `for`  
> - 读取直到满足某条件 → 用 `while`

---

## 8. 小练习

写出以下代码的输出：

```java
for (int i = 0; i < 5; i++) {
    if (i % 2 == 0) {
        continue; // 跳过本次循环剩余部分
    }
    System.out.print(i + " ");
}
```

<details>
<summary>✅ 答案</summary>

- i=0 → 偶数 → `continue`
- i=1 → 奇数 → 输出 `1 `
- i=2 → 偶数 → `continue`
- i=3 → 奇数 → 输出 `3 `
- i=4 → 偶数 → `continue`
- 输出：**1 3**
</details>

---

## 9. 常见错误总结

> [!danger] 初学者易错点

| 错误 | 说明 | 修正 |
|------|------|------|
| 分号位置错误 | `for (int i=0; i<5; i++); { ... }` → 循环体为空 | 删除多余分号 |
| 修改循环变量 | 在循环体内修改 `i` 导致逻辑混乱 | 尽量只在“迭代更新”部分修改 |
| 数组越界 | `i <= arr.length` | 应为 `i < arr.length` |
| 忘记大括号 | 单行循环体后续加代码出错 | 始终使用 `{}` |

---
